<html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Contrato de Locação</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
        <link rel="stylesheet" type="text/css" href="./styles.css">
    </head>
    <body>
    <header>

        <h1>Contrato</h1>
    </header>
        
    <form id="contractForm">
        <select id="fileDropdown">
            <option value="">Selecione um contrato</option>
        </select>
        <div class="section section-gray">
            <label for="tipoLocacao">Tipo da Locação:</label>
            <select id="tipoLocacao" name="tipoLocacao" required="">
                <option value="">Selecione</option>
                <option value="Comercial">Comercial</option>
                <option value="Residencial">Residencial</option>
            </select>

            <label for="locador">Locador</label>
            <input type="text" id="locador" name="locador" required>
            
            <label for="qualificacao">Qualificação</label>
            <input type="text" id="qualificacao" name="qualificacao" required>
            
            <label for="endereco">Endereço</label>
            <input type="text" id="endereco" name="endereco" required>
            
            <label for="rg_locador">RG do Locador</label>
            <input type="text" id="rg_locador" name="rg_locador" required>
            
            <label for="cpf_locador">CPF do Locador</label>
            <input type="text" id="cpf_locador" name="cpf_locador" required>
        </div>

        <div class="section section-blue"> 
            <label for="nome_inquilino">Nome do Inquilino</label>
            <input type="text" id="nome_inquilino" name="nome_inquilino" required>

            <label for="qualificacao_inquilino">Qualificação do Inquilino</label>
            <input type="text" id="qualificacao_inquilino" name="qualificacao_inquilino" required>

            <label for="rg_inquilino">RG do Inquilino</label>
            <input type="text" id="rg_inquilino" name="rg_inquilino" required>

            <label for="cpf_inquilino">CPF do Inquilino</label>
            <input type="text" id="cpf_inquilino" name="cpf_inquilino" required>

            <label for="endereco_movel_locado">Endereço do Imóvel Locado</label>
            <input type="text" id="endereco_movel_locado" name="endereco_movel_locado" required>
        </div>

        <div class="section section-orange">
            <label for="prazo_meses">Prazo (Meses)</label>
            <input type="text" id="prazo_meses" name="prazo_meses" required>
            
            <label for="valor_aluguel">Valor do Aluguel</label>
            <input type="text" id="valor_aluguel" name="valor_aluguel" required>
            
            <label for="valor_aluguel_extenso">Valor do Aluguel por Extenso</label>
            <input type="text" id="valor_aluguel_extenso" name="valor_aluguel_extenso" required>
            
            <label for="dia_pagamento">Dia do Pagamento</label>
            <input type="text" id="dia_pagamento" name="dia_pagamento" required>
            
            <label for="dia_pagamento_extenso">Dia do Pagamento por Extenso</label>
            <input type="text" id="dia_pagamento_extenso" name="dia_pagamento_extenso" required>
            
            <label for="forma_pagamento">Forma de Pagamento</label>
            <input type="text" id="forma_pagamento" name="forma_pagamento" required>
            
            <label for="forum">Fórum</label>
            <input type="text" id="forum" name="forum" required>
            
            <label for="valor_multa">Valor da Multa</label>
            <input type="text" id="valor_multa" name="valor_multa" required>
            
            <label for="valor_multa_extenso">Valor da Multa por Extenso</label>
            <input type="text" id="valor_multa_extenso" name="valor_multa_extenso" required>
        </div>

        <div class="section section-purple">
            <label for="fiador">Fiador</label>
            <input type="text" id="fiador" name="fiador" required>
            
            <label for="qualificacao_fiador">Qualificação do Fiador</label>
            <input type="text" id="qualificacao_fiador" name="qualificacao_fiador" required>
            
            <label for="endereco_fiador">Endereço do Fiador</label>
            <input type="text" id="endereco_fiador" name="endereco_fiador" required>
            
            <label for="rg_fiador">RG do Fiador</label>
            <input type="text" id="rg_fiador" name="rg_fiador" required>
            
            <label for="cpf_fiador">CPF do Fiador</label>
            <input type="text" id="cpf_fiador" name="cpf_fiador" required>

            
            <!-- <label for="foneFiador">Fone do Fiador:</label>
            <input type="text" id="foneFiador" name="foneFiador" required="" pattern="\d{10,11}" title="Digite um número de telefone válido." wfd-id="id19"> -->
        </div>
        
        <div class="section section-pink">
            <label for="esposa_fiador">Esposa do Fiador</label>
            <input type="text" id="esposa_fiador" name="esposa_fiador" required>

            <label for="cpf_esposa_fiador">CPF da Esposa do Fiador</label>
            <input type="text" id="cpf_esposa_fiador" name="cpf_esposa_fiador" required>

            <label for="rg_esposa_fiador">RG da Esposa do Fiador</label>
            <input type="text" id="rg_esposa_fiador" name="rg_esposa_fiador" required>
        </div>

        <div class="section section">
            <label for="propriedade_fiador">Propriedade do Fiador</label>
            <input type="text" id="propriedade_fiador" name="propriedade_fiador" required>
        </div>

        <div class="section section-yellow">
            <label for="clausula22">Cláusula 22 - Extraordinária:</label>
            <textarea id="clausula22" name="clausula22"></textarea>

            <label for="clausula23">Cláusula 23 - Extraordinária:</label>
            <textarea id="clausula23" name="clausula23"></textarea>

            <label for="clausula24">Cláusula 24 - Extraordinária:</label>
            <textarea id="clausula24" name="clausula24"></textarea>

            <label for="clausula25">Cláusula 25 - Extraordinária:</label>
            <textarea id="clausula25" name="clausula25"></textarea>
        </div>

        <div class="section section-red">
            <label for="local_assinatura">Local da Assinatura</label>
            <input type="text" id="local_assinatura" name="local_assinatura" required>
            
            <label for="data_assinatura">Data da Assinatura</label>
            <input type="text" id="data_assinatura" name="data_assinatura" required>
            
            <label for="testemunha1">Testemunha 1</label>
            <input type="text" id="testemunha1" name="testemunha1" required>
            
            <label for="testemunha2">Testemunha 2</label>
            <input type="text" id="testemunha2" name="testemunha2" required>
        </div>

        <div class="attention">
            ATENÇÃO! Os dados enviados preencherão o Contrato de Locação padrão, que poderá ser impresso ou copiado para o Word para alterações, e serão descartados, não ficando armazenados.
        </div>

        <input type="button" onclick="GeneratePDF2()" value="Gerar PDF" wfd-id="id25">
        <button type="reset">Limpar</button>
        <button type="button" onclick="window.history.back()">Voltar</button>
    </form>

    <footer>
        <p>Desenvolvido por [Seu Nome]</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        const dropdown = document.getElementById('fileDropdown');

        fetch(window.location.href + 'contratos.json')
            .then(response => response.json())
            .then(data => {
            data.contratos.forEach(file => {
                const option = document.createElement('option');
                option.value = file;
                option.textContent = file;
                dropdown.appendChild(option);
            });
            })
            .catch(error => console.error('Erro ao carregar a lista de arquivos:', error));
        });

        function GeneratePDF2(){
            let contratoFinal = "";
            
            fetch(window.location.href + document.getElementById('fileDropdown').value)
                .then(response => response.text())
                .then(text => contratoFinal = text)

            contratoFinal = contratoFinal.replaceAll('{{LOCADOR}}', document.getElementById('locador').value);
            contratoFinal = contratoFinal.replaceAll('{{QUALIFICACAO}}', document.getElementById('qualificacao').value);
            contratoFinal = contratoFinal.replaceAll('{{ENDERECO}}', document.getElementById('endereco').value);
            contratoFinal = contratoFinal.replaceAll('{{RG_LOCADOR}}', document.getElementById('rg_locador').value);
            contratoFinal = contratoFinal.replaceAll('{{CPF_LOCADOR}}', document.getElementById('cpf_locador').value);
            contratoFinal = contratoFinal.replaceAll('{{NOME_INQUILINO}}', document.getElementById('nome_inquilino').value);
            contratoFinal = contratoFinal.replaceAll('{{QUALIFICACAO_INQUILINO}}', document.getElementById('qualificacao_inquilino').value);
            contratoFinal = contratoFinal.replaceAll('{{RG_INQUILINO}}', document.getElementById('rg_inquilino').value);
            contratoFinal = contratoFinal.replaceAll('{{CPF_INQUILINO}}', document.getElementById('cpf_inquilino').value);
            contratoFinal = contratoFinal.replaceAll('{{ENDERECO_MOVEL_LOCADO}}', document.getElementById('endereco_movel_locado').value);
            contratoFinal = contratoFinal.replaceAll('{{PRAZO_MESES}}', document.getElementById('prazo_meses').value);
            contratoFinal = contratoFinal.replaceAll('{{VALOR_ALUGUEL}}', document.getElementById('valor_aluguel').value);
            contratoFinal = contratoFinal.replaceAll('{{VALOR_ALUGUEL_EXTENSO}}', document.getElementById('valor_aluguel_extenso').value);
            contratoFinal = contratoFinal.replaceAll('{{DIA_PAGAMENTO}}', document.getElementById('dia_pagamento').value);
            contratoFinal = contratoFinal.replaceAll('{{DIA_PAGAMENTO_EXTENSO}}', document.getElementById('dia_pagamento_extenso').value);
            contratoFinal = contratoFinal.replaceAll('{{FORMA_PAGAMENTO}}', document.getElementById('forma_pagamento').value);
            contratoFinal = contratoFinal.replaceAll('{{FORUM}}', document.getElementById('forum').value);
            contratoFinal = contratoFinal.replaceAll('{{VALOR_MULTA}}', document.getElementById('valor_multa').value);
            contratoFinal = contratoFinal.replaceAll('{{VALOR_MULTA_EXTENSO}}', document.getElementById('valor_multa_extenso').value);
            contratoFinal = contratoFinal.replaceAll('{{FIADOR}}', document.getElementById('fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{QUALIFICACAO_FIADOR}}', document.getElementById('qualificacao_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{ENDERECO_FIADOR}}', document.getElementById('endereco_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{RG_FIADOR}}', document.getElementById('rg_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{CPF_FIADOR}}', document.getElementById('cpf_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{ESPOSA_FIADOR}}', document.getElementById('esposa_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{PROPRIEDADE_FIADOR}}', document.getElementById('propriedade_fiador').value);
            contratoFinal = contratoFinal.replaceAll('{{LOCAL_ASSINATURA}}', document.getElementById('local_assinatura').value);
            contratoFinal = contratoFinal.replaceAll('{{DATA_ASSINATURA}}', document.getElementById('data_assinatura').value);
            contratoFinal = contratoFinal.replaceAll('{{TESTEMUNHA1}}', document.getElementById('testemunha1').value);
            contratoFinal = contratoFinal.replaceAll('{{TESTEMUNHA2}}', document.getElementById('testemunha2').value);

            var contratoPartes = contratoFinal.split('\n');

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            var size = 20;
            const fontSize = 12; // Tamanho da fonte em pontos
            const fatorConversao = 0.3528; // 1 ponto ≈ 0.3528 mm
            const alturaLinha = fontSize * fatorConversao;
            var alturaTexto = 0; 
            var linhas;

            doc.setFont("Helvetica", "bold");
            doc.setFontSize(fontSize);
            
            contratoPartes.forEach((item, index)=>{
                linhas = doc.splitTextToSize(item, 170);
                alturaTexto = linhas.length * alturaLinha;

                if(size + alturaTexto >= 297){
                    doc.addPage();
                    size = 20;
                }

                doc.text(item, 20, size, { maxWidth: 170 });
                size += alturaTexto + fatorConversao * 5;
            })
            doc.save("Contrato_de_Locação.pdf");
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const tipoLocacao = document.getElementById('tipoLocacao').value;
            const nomeLocador = document.getElementById('nomeLocador').value;
            const qualificacaoLocador = document.getElementById('qualificacaoLocador').value;
            const enderecoLocador = document.getElementById('enderecoLocador').value;
            const rgLocador = document.getElementById('rgLocador').value;
            const cpfLocador = document.getElementById('cpfLocador').value;

            const nomeInquilino = document.getElementById('nomeInquilino').value;
            const qualificacaoInquilino = document.getElementById('qualificacaoInquilino').value;
            const rgInquilino = document.getElementById('rgInquilino').value;
            const cpfInquilino = document.getElementById('cpfInquilino').value;
            const enderecoImovel = document.getElementById('enderecoImovel').value;

            const prazoContrato = document.getElementById('prazoContrato').value;
            const dataInicial = document.getElementById('dataInicial').value;
            const dataFinal = document.getElementById('dataFinal').value;
            const valorAluguel = document.getElementById('valorAluguel').value;
            const diaPagamento = document.getElementById('diaPagamento').value;
            const formaPagamento = document.getElementById('formaPagamento').value;
            const multaContratual = document.getElementById('multaContratual').value;
            const forum = document.getElementById('forum').value;

            const nomeFiador = document.getElementById('nomeFiador').value;
            const qualificacaoFiador = document.getElementById('qualificacaoFiador').value;
            const enderecoFiador = document.getElementById('enderecoFiador').value;
            const rgFiador = document.getElementById('rgFiador').value;
            const cpfFiador = document.getElementById('cpfFiador').value;
            const foneFiador = document.getElementById('foneFiador').value;

            const nomeEsposaFiador = document.getElementById('nomeEsposaFiador').value;
            const rgEsposaFiador = document.getElementById('rgEsposaFiador').value;
            const cpfEsposaFiador = document.getElementById('cpfEsposaFiador').value;

            const propriedadeFiador = document.getElementById('propriedadeFiador').value;

            const clausula22 = document.getElementById('clausula22').value || "-";
            const clausula23 = document.getElementById('clausula23').value || "-";
            const clausula24 = document.getElementById('clausula24').value || "-";
            const clausula25 = document.getElementById('clausula25').value || "-";

            const localAssinatura = document.getElementById('localAssinatura').value;
            const dataAssinatura = document.getElementById('dataAssinatura').value;
            const doctText = [];

            doc.setFont("Helvetica", "bold");
            doc.setFontSize(14);
            doctText.push("CONTRATO DE LOCAÇÃO");

            doc.setFont("Helvetica", "normal");
            doc.setFontSize(10);
            doctText.push(`Os signatários deste instrumento, de um lado, ${nomeLocador}, residente e domiciliado à ${enderecoLocador}, portador do RG Nº ${rgLocador} e CPF Nº ${cpfLocador},`);
            doctText.push(`adiante denominado simplesmente LOCADOR e de outro, ${nomeInquilino}, portador do RG Nº ${rgInquilino} e CPF Nº ${cpfInquilino},`);
            doctText.push(`adiante denominado simplesmente LOCATÁRIO, têm entre si justo e contratado o seguinte, que mutuamente aceitam e outorgam, a saber:`);

            doctText.push(`O LOCADOR, sendo proprietário do imóvel sito à ${enderecoImovel}, adiante designado como "IMÓVEL LOCADO", loca-o ao LOCATÁRIO`);
            doctText.push(`mediante as cláusulas e condições adiante estipuladas, ou sejam:`);

            doctText.push(`1ª) O prazo de locação é de ${prazoContrato} meses, iniciando em ${dataInicial} e terminando em ${dataFinal}, data em que o LOCATÁRIO`);
            doctText.push(`se obriga a restituir o IMÓVEL LOCADO completamente desocupado, no estado em que o recebeu, independentemente de notificação ou`);
            doctText.push(`2ª) O aluguel mensal é de R$ ${valorAluguel}, que o LOCATÁRIO se compromete a pagar pontualmente, até o dia ${diaPagamento} de cada mês, da seguinte forma: ${formaPagamento}.`);

            doctText.push(`3ª) O LOCATÁRIO, salvo as obras que importem na segurança do IMÓVEL LOCADO, obriga-se por todas as outras, devendo trazer o IMÓVEL LOCADO em boas condições de higiene e limpeza,`);
            doctText.push(`com os aparelhos sanitários e de iluminação, fogão, papéis, pinturas, telhados, vidraças, mármores, fechos, torneiras, pias, banheiros, ralos e demais acessórios em perfeito estado de conservação e funcionamento.`);

            doctText.push(`4ª) Obriga-se mais o LOCATÁRIO a satisfazer a todas as exigências dos Poderes Públicos, a que der causa, e a não transferir este contrato, nem fazer modificações ou transformações no IMÓVEL LOCADO sem autorização escrita do LOCADOR.`);

            doctText.push(`5ª) O LOCATÁRIO desde já autoriza a vistoria do imóvel locado, quando o LOCADOR achar necessário.`);

            doctText.push(`6ª) O LOCATÁRIO também não poderá sublocar, ceder, nem emprestar o IMÓVEL LOCADO no todo ou em parte, sem o consentimento por escrito do LOCADOR.`);

            doctText.push(`7ª) No caso de desapropriação do IMÓVEL LOCADO, ficará o LOCADOR desobrigado de todas as cláusulas deste contrato, ressalvada ao LOCATÁRIO, tão somente, a faculdade de haver do poder desapropriante a indenização a que, porventura, tiver direito.`);

            doctText.push(`8ª) Para todas as questões resultantes deste contrato, será competente o foro de ${forum}.`);

            doctText.push(`Clasula primeira) ${clausula22}`);

            doctText.push(`Clasula segunda) ${clausula23}`);

            doctText.push(`Clasula terceira) ${clausula24}`);

            doctText.push(`Clasula quarta) ${clausula25}`);

        
            doctText.push(`Local e Data: ${localAssinatura}, ${dataAssinatura}`);
            doctText.push(`Locador: ${nomeLocador}`);
            doctText.push(`Locatário: ${nomeInquilino}`);
            doctText.push(`Fiador: ${nomeFiador}`);
            var size = 20;
            const fontSize = 12; // Tamanho da fonte em pontos
            const fatorConversao = 0.3528; // 1 ponto ≈ 0.3528 mm
            const alturaLinha = fontSize * fatorConversao;
            var alturaTexto = 0; 
            var linhas;
            
            doctText.forEach((item, index)=>{
                linhas = doc.splitTextToSize(item, 170);
                alturaTexto = linhas.length * alturaLinha;

                if(size + alturaTexto >= 297){
                    doc.addPage();
                    size = 20;
                }

                doc.text(item, 20, size, { maxWidth: 170 });
                size += alturaTexto + fatorConversao * 5;
            })
            doc.save("Contrato_de_Locação.pdf");
            
            
            // Enviar o PDF por e-mail
            
    
        }
    </script>
    </body>
</html>